import b from"./DCrISlLf.js";import{_ as v,x as u,y as m,z as r,B as a,D as f,A as h,I as p,J as g,K as x,L as N,M as y,N as V,O,P,Q as S,R as F}from"#entry";const k={name:"ContadoresFiltros",props:{filtroNombre:{type:String,default:""},ordenarPor:{type:String,default:""},direccionOrden:{type:String,default:"asc"},tipoFiltroValor:{type:String,default:""},valorFiltro:{type:[Number,null],default:null}},emits:["filters-change","clear-filters"],data(){return{mostrarFiltros:!1}},computed:{hayFiltrosActivos(){return this.filtroNombre.trim()||this.ordenarPor||this.tipoFiltroValor},conteoFiltrosActivos(){let t=0;return this.filtroNombre.trim()&&t++,this.ordenarPor&&t++,this.tipoFiltroValor&&t++,t}},mounted(){const t=sessionStorage.getItem("contadores_filtros_toggle");t!==null&&(this.mostrarFiltros=JSON.parse(t))},methods:{toggleFiltros(){this.mostrarFiltros=!this.mostrarFiltros,sessionStorage.setItem("contadores_filtros_toggle",JSON.stringify(this.mostrarFiltros))},updateFiltroNombre(t){this.emitFiltersChange({filtroNombre:t.target.value})},updateOrdenarPor(t){this.emitFiltersChange({ordenarPor:t.target.value})},updateDireccionOrden(t){this.emitFiltersChange({direccionOrden:t.target.value})},updateTipoFiltroValor(t){this.emitFiltersChange({tipoFiltroValor:t.target.value})},updateValorFiltro(t){const o=t.target.value?Number(t.target.value):null;this.emitFiltersChange({valorFiltro:o})},emitFiltersChange(t={}){this.$emit("filters-change",{filtroNombre:t.filtroNombre??this.filtroNombre,ordenarPor:t.ordenarPor??this.ordenarPor,direccionOrden:t.direccionOrden??this.direccionOrden,tipoFiltroValor:t.tipoFiltroValor??this.tipoFiltroValor,valorFiltro:t.valorFiltro??this.valorFiltro})},limpiarFiltros(){this.$emit("clear-filters")}}},w={class:"filtros"},A={class:"u-flex u-flex--justify-between u-flex--center u-mb--md"},I={class:"u-mb--none u-text--muted"},L=["aria-expanded"],T={class:"u-mb--md"},E={class:"form__label u-text--sm u-text--semibold"},B=["value"],D={class:"filtros__grid u-mb--md"},j={class:"form__field"},z={class:"form__label u-text--sm u-text--semibold"},J={class:"u-flex u-gap--sm"},M=["value"],K=["value","disabled"],U={class:"form__field"},G={class:"form__label u-text--sm u-text--semibold"},Q={class:"u-flex u-gap--sm"},R=["value"],q=["value","disabled"],H={key:0,class:"u-flex u-flex--justify-between u-flex--center"},W={class:"filtros__activos"},X={class:"u-text--muted"};function Y(t,o,i,c,s,e){const d=b;return m(),u("div",w,[r("div",A,[r("h6",I,[a(d,{name:"heroicons:funnel",class:"u-me--sm"}),o[7]||(o[7]=f(" Filtros y Ordenamiento ",-1))]),r("button",{class:"btn btn--outline-secondary btn--sm","aria-expanded":s.mostrarFiltros,"aria-controls":"filtros-content",onClick:o[0]||(o[0]=(...n)=>e.toggleFiltros&&e.toggleFiltros(...n))},[a(d,{name:s.mostrarFiltros?"heroicons:chevron-up":"heroicons:chevron-down"},null,8,["name"]),f(" "+h(s.mostrarFiltros?"Ocultar":"Mostrar"),1)],8,L)]),r("div",{id:"filtros-content",class:g(["filtros__content",{"filtros__content--show":s.mostrarFiltros}])},[r("div",T,[r("label",E,[a(d,{name:"heroicons:magnifying-glass",class:"u-me--xs"}),o[8]||(o[8]=f(" Buscar por nombre ",-1))]),r("input",{value:i.filtroNombre,type:"text",class:"form__input",placeholder:"Escriba el nombre del contador...",onInput:o[1]||(o[1]=(...n)=>e.updateFiltroNombre&&e.updateFiltroNombre(...n))},null,40,B)]),r("div",D,[r("div",j,[r("label",z,[a(d,{name:"heroicons:bars-arrow-up",class:"u-me--xs"}),o[9]||(o[9]=f(" Ordenar por ",-1))]),r("div",J,[r("select",{value:i.ordenarPor,class:"form__input form__input--sm",onChange:o[2]||(o[2]=(...n)=>e.updateOrdenarPor&&e.updateOrdenarPor(...n))},[...o[10]||(o[10]=[r("option",{value:""},"Sin ordenar",-1),r("option",{value:"nombre"},"Nombre",-1),r("option",{value:"valor"},"Valor",-1)])],40,M),r("select",{value:i.direccionOrden,disabled:!i.ordenarPor,class:"form__input form__input--sm",onChange:o[3]||(o[3]=(...n)=>e.updateDireccionOrden&&e.updateDireccionOrden(...n))},[...o[11]||(o[11]=[r("option",{value:"asc"},"Ascendente",-1),r("option",{value:"desc"},"Descendente",-1)])],40,K)])]),r("div",U,[r("label",G,[a(d,{name:"heroicons:adjustments-horizontal",class:"u-me--xs"}),o[12]||(o[12]=f(" Filtrar por valor ",-1))]),r("div",Q,[r("select",{value:i.tipoFiltroValor,class:"form__input form__input--sm",onChange:o[4]||(o[4]=(...n)=>e.updateTipoFiltroValor&&e.updateTipoFiltroValor(...n))},[...o[13]||(o[13]=[r("option",{value:""},"Sin filtro",-1),r("option",{value:"mayor"},"Mayor a",-1),r("option",{value:"menor"},"Menor a",-1)])],40,R),r("input",{value:i.valorFiltro,type:"number",class:"form__input form__input--sm",placeholder:"Valor",min:"0",max:"20",disabled:!i.tipoFiltroValor,onInput:o[5]||(o[5]=(...n)=>e.updateValorFiltro&&e.updateValorFiltro(...n))},null,40,q)])])]),e.hayFiltrosActivos?(m(),u("div",H,[r("div",W,[r("small",X,[a(d,{name:"heroicons:information-circle",class:"u-me--xs"}),f(" "+h(e.conteoFiltrosActivos)+" filtro(s) aplicado(s) ",1)])]),r("button",{class:"btn btn--outline-danger btn--sm",title:"Limpiar todos los filtros",onClick:o[6]||(o[6]=(...n)=>e.limpiarFiltros&&e.limpiarFiltros(...n))},[a(d,{name:"heroicons:x-mark",class:"u-me--xs"}),o[14]||(o[14]=f(" Limpiar filtros ",-1))])])):p("",!0)],2)])}const Z=Object.assign(v(k,[["render",Y],["__scopeId","data-v-e72e31dd"]]),{__name:"ContadoresFiltros"}),$={data(){return{filtroNombre:"",ordenarPor:"",direccionOrden:"asc",tipoFiltroValor:"",valorFiltro:null}},computed:{...N("contadores",{listaContadores:"listaContadores",puedeAgregarContador:"puedeAgregarContador",cantidadContadores:"cantidadContadores",maxContadores:"maxContadores",maxValorContador:"maxValorContador",maxCaracteresNombre:"maxCaracteresNombre"}),contadoresFiltrados(){let t=[...this.listaContadores];return this.filtroNombre.trim()&&(t=t.filter(o=>o.nombre.toLowerCase().includes(this.filtroNombre.toLowerCase()))),this.tipoFiltroValor&&this.valorFiltro!==null&&(this.tipoFiltroValor==="mayor"?t=t.filter(o=>o.valor>this.valorFiltro):this.tipoFiltroValor==="menor"&&(t=t.filter(o=>o.valor<this.valorFiltro))),this.ordenarPor&&t.sort((o,i)=>{let c,s;return this.ordenarPor==="nombre"?(c=o.nombre.toLowerCase(),s=i.nombre.toLowerCase()):this.ordenarPor==="valor"&&(c=o.valor,s=i.valor),this.direccionOrden==="asc"?c<s?-1:c>s?1:0:c>s?-1:c<s?1:0}),t},sumaTotal(){return this.listaContadores.reduce((t,o)=>t+o.valor,0)},hayFiltrosActivos(){return this.filtroNombre.trim()||this.ordenarPor||this.tipoFiltroValor}},mounted(){this.loadContadores(),this.loadFiltersFromSession()},methods:{...x("contadores",{removeContador:"removeContador",incrementarContador:"incrementarContador",decrementarContador:"decrementarContador",editarNombreContador:"editarNombreContador",loadContadores:"loadContadores"}),eliminarContador(t){this.removeContador(t)},startEdit(t){const o=this.listaContadores.find(i=>i.id===t);o&&(o.editando=!0)},finishEdit(t){const o=this.listaContadores.find(i=>i.id===t);o&&(this.editarNombreContador({id:t,nombre:o.nombre}),o.editando=!1)},cancelEdit(t){const o=this.listaContadores.find(i=>i.id===t);o&&(this.loadContadores(),o.editando=!1)},handleFiltersChange(t){this.filtroNombre=t.filtroNombre,this.ordenarPor=t.ordenarPor,this.direccionOrden=t.direccionOrden,this.tipoFiltroValor=t.tipoFiltroValor,this.valorFiltro=t.valorFiltro,this.saveFiltersToSession()},limpiarTodosFiltros(){this.filtroNombre="",this.ordenarPor="",this.direccionOrden="asc",this.tipoFiltroValor="",this.valorFiltro=null,sessionStorage.removeItem("contadores_filtros")},saveFiltersToSession(){const t={filtroNombre:this.filtroNombre,ordenarPor:this.ordenarPor,direccionOrden:this.direccionOrden,tipoFiltroValor:this.tipoFiltroValor,valorFiltro:this.valorFiltro};sessionStorage.setItem("contadores_filtros",JSON.stringify(t))},loadFiltersFromSession(){const t=sessionStorage.getItem("contadores_filtros");if(t)try{const o=JSON.parse(t);this.filtroNombre=o.filtroNombre||"",this.ordenarPor=o.ordenarPor||"",this.direccionOrden=o.direccionOrden||"asc",this.tipoFiltroValor=o.tipoFiltroValor||"",this.valorFiltro=o.valorFiltro||null}catch(o){console.warn("Error al cargar filtros desde sessionStorage:",o)}}}},oo={class:"lista-contadores"},to={class:"card u-p--md"},ro={key:1,class:"empty-state u-text--center u-py--lg"},eo={class:"empty-state__icon u-mb--md"},io={class:"contador-item__list"},so={class:"contador-item__content"},no={class:"contador-item__nombre"},lo=["onClick"],ao=["onUpdate:modelValue","onBlur","onKeydown"],mo=["disabled","onClick"],co={class:"contador-item__valor"},uo=["onClick"],_o=["onClick"];function fo(t,o,i,c,s,e){const d=Z,n=b;return m(),u("div",oo,[r("div",to,[t.listaContadores.length>0?(m(),y(d,{key:0,"filtro-nombre":s.filtroNombre,"ordenar-por":s.ordenarPor,"direccion-orden":s.direccionOrden,"tipo-filtro-valor":s.tipoFiltroValor,"valor-filtro":s.valorFiltro,onFiltersChange:e.handleFiltersChange,onClearFilters:e.limpiarTodosFiltros},null,8,["filtro-nombre","ordenar-por","direccion-orden","tipo-filtro-valor","valor-filtro","onFiltersChange","onClearFilters"])):p("",!0),t.listaContadores.length===0?(m(),u("div",ro,[r("div",eo,[a(n,{name:"heroicons:plus-circle-16-solid",size:"64",style:{color:"var(--secondary)"}})]),o[0]||(o[0]=r("h5",{class:"u-text--muted"},"No hay contadores disponibles",-1)),o[1]||(o[1]=r("p",{class:"u-text--muted"},'Usa el botÃ³n "Agregar Contador" en el header para comenzar',-1))])):p("",!0),r("ul",io,[(m(!0),u(V,null,O(e.contadoresFiltrados,l=>(m(),u("li",{key:l.id,class:"contador-item"},[r("div",so,[r("div",no,[l.editando?P((m(),u("input",{key:1,"onUpdate:modelValue":_=>l.nombre=_,class:"contador-item__input",type:"text",onBlur:_=>e.finishEdit(l.id),onKeydown:[F(_=>e.finishEdit(l.id),["enter"]),F(_=>e.cancelEdit(l.id),["escape"])]},null,40,ao)),[[S,l.nombre]]):(m(),u("div",{key:0,class:"contador-item__name-display",onClick:_=>e.startEdit(l.id)},h(l.nombre),9,lo))]),r("button",{class:"btn btn--outline-warning btn--sm",disabled:l.valor===0,onClick:_=>t.decrementarContador(l.id)},[a(n,{name:"heroicons:minus"})],8,mo),r("div",co,h(l.valor),1),r("button",{class:"btn btn--outline-success btn--sm",onClick:_=>t.incrementarContador(l.id)},[a(n,{name:"heroicons:plus"})],8,uo),r("button",{class:"btn btn--outline-danger btn--sm",onClick:_=>e.eliminarContador(l.id)},[a(n,{name:"heroicons:trash"})],8,_o)])]))),128))])])])}const C=Object.assign(v($,[["render",fo]]),{__name:"ListaContadores"}),ho={components:{ListaContadores:C}};function po(t,o,i,c,s,e){const d=C;return m(),u("div",null,[a(d)])}const bo=v(ho,[["render",po]]);export{bo as default};
